<!DOCTYPE html>
<html>
  <meta charset="utf-8" />
  <body>
    <script src="//d3js.org/d3.v4.min.js"></script>

    <script
      src="https://unpkg.com/viz.js@1.8.2/viz.js"
      type="javascript/worker"
    ></script>
    <script src="https://unpkg.com/d3-graphviz@2.6.1/build/d3-graphviz.min.js"></script>

    <div id="graph" style="text-align: center;"></div>

    <script>
      var graphviz = d3
        .select('#graph')
        .graphviz({
          engine: 'fdp',
          fit: true,
          width: window.screen.availWidth,
          height: window.screen.availHeight,
        })
        .transition(function() {
          return d3
            .transition('main')
            .ease(d3.easeLinear)
            .delay(10)
            .duration(1000);
        })
        .logEvents(true)
        .on('initEnd', render);

      async function render() {
        const res = await fetch('/graph?format=dot');
        const dot = await res.text();
        graphviz.renderDot(dot);
      }
    </script>
  </body>
</html>
